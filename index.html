<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صدقة جارية | عمي مصطفى محمد حسن</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --p: #0d1b0f; --g: #d4af37; --c: #1a291c; --t: #f5f5f5; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--p); color: var(--t); padding-bottom: 70px; }
        .header { background: #000; padding: 30px 15px; text-align: center; border-bottom: 3px solid var(--g); }
        .header h1 { color: var(--g); font-size: 1.8rem; }
        .nav-bar { position: sticky; top: 0; background: #000; z-index: 1000; display: flex; overflow-x: auto; padding: 10px; gap: 8px; border-bottom: 1px solid var(--g); }
        .nav-btn { background: var(--c); color: white; border: 1px solid var(--g); padding: 8px 18px; border-radius: 20px; cursor: pointer; white-space: nowrap; }
        .nav-btn.active { background: var(--g); color: #000; font-weight: bold; }
        .container { padding: 15px; max-width: 800px; margin: auto; }
        .section { display: none; }
        .section.active { display: block; }
        .chat-box { background: var(--c); border-radius: 15px; height: 450px; display: flex; flex-direction: column; overflow: hidden; border: 1px solid #333; }
        .chat-msgs { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .msg { max-width: 85%; padding: 12px; border-radius: 12px; font-size: 0.95rem; line-height: 1.5; }
        .bot { background: #254a2e; align-self: flex-start; }
        .user { background: var(--g); color: #000; align-self: flex-end; }
        .chat-in { display: flex; padding: 10px; background: #000; gap: 8px; }
        .chat-in input { flex: 1; padding: 12px; border-radius: 25px; border: none; outline: none; }
        .chat-in button { background: var(--g); border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px; }
        .card { background: var(--c); padding: 20px; border-radius: 12px; border-right: 4px solid var(--g); cursor: pointer; transition: 0.3s; }
        .card:hover { background: #223a26; }
        .modal { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); display:none; z-index:9999; justify-content:center; align-items:center; padding:20px; }
        .modal-box { background: #111; border: 2px solid var(--g); padding: 25px; border-radius: 15px; text-align: center; width: 100%; max-width: 500px; position: relative; }
        .close-m { position: absolute; top: 5px; left: 10px; color: red; font-size: 1.5rem; cursor: pointer; }
        .player-bar { position: fixed; bottom: 0; width: 100%; background: var(--g); color: #000; padding: 12px; display: none; justify-content: space-between; align-items: center; font-weight: bold; z-index: 5000; }
        .sebha-btn { width: 180px; height: 180px; border-radius: 50%; border: 6px solid var(--g); margin: 30px auto; display: flex; flex-direction: column; align-items: center; justify-content: center; background: var(--c); cursor: pointer; }
    </style>
</head>
<body>

    <div class="header">
        <p>صدقة جارية لروح</p>
        <h1>عمي مصطفى محمد حسن</h1>
    </div>

    <div class="nav-bar">
        <button class="nav-btn active" onclick="show('ai', this)">Saif AI</button>
        <button class="nav-btn" onclick="show('hesn', this)">حصن المسلم</button>
        <button class="nav-btn" onclick="show('duaa', this)">أدعية</button>
        <button class="nav-btn" onclick="show('quran', this)">المصحف</button>
        <button class="nav-btn" onclick="show('radio', this)">الإذاعة</button>
        <button class="nav-btn" onclick="show('sebha', this)">السبحة</button>
    </div>

    <div class="container">
        <div id="ai" class="section active">
            <div class="chat-box">
                <div class="chat-msgs" id="chatMsgs">
                    <div class="msg bot">مرحباً يا سيف! أنا مساعدك الذكي Saif AI. اسألني عن أي حديث أو دعاء لروح عمك مصطفى وسأجيبك فوراً.</div>
                </div>
                <div class="chat-in">
                    <input type="text" id="chatInput" placeholder="اكتب سؤالك هنا..." onkeypress="if(event.key==='Enter') ask()">
                    <button onclick="ask()"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>

        <div id="hesn" class="section">
            <div class="grid" id="hesnGrid"></div>
        </div>

        <div id="duaa" class="section">
            <div class="grid" id="duaaGrid"></div>
        </div>

        <div id="quran" class="section">
            <iframe src="https://tanzil.net/#1:1" style="width:100%; height:75vh; border-radius:15px; background: white;"></iframe>
        </div>

        <div id="radio" class="section">
            <div class="grid">
                <div class="card" onclick="play('https://stream.radiojar.com/8s5u5tpdtwzuv', 'إذاعة القاهرة')"><h3>إذاعة القرآن من القاهرة</h3><p>بث مباشر</p></div>
                <div class="card" onclick="play('https://qurango.net/radio/mohammad_siddiq_alminshawi_mojawwad.mp3', 'المنشاوي')"><h3>الشيخ المنشاوي</h3><p>المصحف المجود</p></div>
                <div class="card" onclick="play('https://qurango.net/radio/abdulbasit_abdulsamad.mp3', 'عبدالباسط عبدالصمد')"><h3>عبدالباسط عبدالصمد</h3><p>المصحف المرتل</p></div>
            </div>
        </div>

        <div id="sebha" class="section" style="text-align:center;">
            <div class="sebha-btn" onclick="countS()">
                <h1 id="sNum">0</h1>
                <p>اضغط للتسبيح</p>
            </div>
            <button class="nav-btn" onclick="resetS()" style="background:#cc0000; border:none;">تصفير</button>
        </div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-box">
            <span class="close-m" onclick="document.getElementById('modal').style.display='none'">&times;</span>
            <h3 id="mTitle" style="color:var(--g); margin-bottom:15px;"></h3>
            <p id="mText" style="font-size:1.2rem; line-height:1.8;"></p>
        </div>
    </div>

    <div class="player-bar" id="pBar">
        <span id="pTitle"></span>
        <button class="nav-btn" style="background:red; border:none; color:white; padding:5px 10px;" onclick="stopP()">إيقاف</button>
    </div>
    <audio id="audio"></audio>

    <script>
        // دالة الذكاء الاصطناعي الحقيقي باستخدام API
        async function ask() {
            const API_KEY = "AIzaSyDLbkXGGhVqmAG_TlJ0r-vkgyqacuz2RqE";
            let inp = document.getElementById('chatInput');
            let box = document.getElementById('chatMsgs');
            let val = inp.value.trim();
            if(!val) return;

            box.innerHTML += `<div class="msg user">${val}</div>`;
            inp.value = "";
            box.scrollTop = box.scrollHeight;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: `أنت مساعد ذكاء اصطناعي في موقع "صدقة جارية" لروح المرحوم (مصطفى محمد حسن). رد على المستخدم باللهجة المصرية وبأسلوب ديني محترم. السؤال: ${val}` }]
                        }]
                    })
                });

                const data = await response.json();
                let reply = data.candidates[0].content.parts[0].text;

                box.innerHTML += `<div class="msg bot">${reply}</div>`;
            } catch (error) {
                box.innerHTML += `<div class="msg bot">حدث خطأ، يرجى المحاولة لاحقاً.</div>`;
            }
            box.scrollTop = box.scrollHeight;
        }

        // أذكار حصن المسلم - من الكود الأصلي الخاص بك
        const hesn = [
            {t:"أذكار الصباح", c:"أصبحنا وأصبح الملك لله، والحمد لله، لا إله إلا الله وحده لا شريك له.."},
            {t:"أذكار المساء", c:"أمسينا وأمسى الملك لله، والحمد لله، لا إله إلا الله وحده لا شريك له.."},
            {t:"سيد الاستغفار", c:"اللهم أنت ربي لا إله إلا أنت، خلقتني وأنا عبدك، وأنا على عهدك ووعدك ما استطعت.."},
            {t:"عند الهم والحزن", c:"اللهم إني أعوذ بك من الهم والحزن، والعجز والكسل، والبخل والجبن.."},
            {t:"دعاء للميت", c:"اللهم اغفر له وارحمه، وعافه واعف عنه، وأكرم نزله، ووسع مدخله، واغسله بالماء والثلج والبرد.."}
        ];

        const hGrid = document.getElementById('hesnGrid');
        hesn.forEach(i => {
            hGrid.innerHTML += `<div class="card" onclick="openM('${i.t}','${i.c}')"><h3>${i.t}</h3><p>اضغط للقراءة</p></div>`;
        });

        const dGrid = document.getElementById('duaaGrid');
        const prayers = [
            "اللهم اغفر لعمي مصطفى وارحمه.", "اللهم اجعل الجنة مثواه.", "اللهم آنس وحشته في قبره.",
            "اللهم نقه من الخطايا كما ينقى الثوب الأبيض من الدنس.", "اللهم ابدله داراً خيراً من داره."
        ];
        prayers.forEach(p => { dGrid.innerHTML += `<div class="card">${p}</div>`; });

        function show(id, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
            window.scrollTo(0,0);
        }

        function openM(t, c) {
            document.getElementById('mTitle').innerText = t;
            document.getElementById('mText').innerText = c;
            document.getElementById('modal').style.display = 'flex';
        }

        let audio = document.getElementById('audio');
        function play(url, t) {
            audio.src = url; audio.play();
            document.getElementById('pTitle').innerText = "شغال: " + t;
            document.getElementById('pBar').style.display = 'flex';
        }
        function stopP() { audio.pause(); document.getElementById('pBar').style.display = 'none'; }

        let s = 0;
        function countS() { s++; document.getElementById('sNum').innerText = s; }
        function resetS() { s=0; document.getElementById('sNum').innerText = 0; }
    </script>
</body>
</html>